<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurateur Technique TEST Lumiscaphe</title>
    <meta name="description" content="Configurateur Technique TEST Lumiscaphe">
    <meta name="author" content="Lumiscaphe">

    <!-- Styles CSS -->
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/viewport.css">
    <link rel="stylesheet" href="styles/controls.css">
    <link rel="stylesheet" href="styles/animations.css">
    <link rel="stylesheet" href="styles/mobile-menu.css">
    <link rel="stylesheet" href="styles/medium-screen.css">
    <link rel="stylesheet" href="styles/config-schema.css">
</head>
<body>
    <!-- Header -->
    <header class="app-header">
        <div class="header-content">
            <button id="burgerMenuBtn" class="burger-menu-btn" aria-label="Menu">
                <span class="burger-line"></span>
                <span class="burger-line"></span>
                <span class="burger-line"></span>
            </button>
            <div class="header-text">
                <h1>Configurateur Technique TEST Lumiscaphe</h1>
                <p class="app-subtitle">Plateforme de test et validation technique</p>
            </div>
            <button id="configSchemaBtn" class="config-schema-btn" aria-label="Sch√©mas XML">
                ‚öôÔ∏è Configuration
            </button>
        </div>
    </header>

    <!-- Mobile Sidebar Menu (slide-in) -->
    <div id="mobileSidebar" class="mobile-sidebar">
        <div class="mobile-sidebar-header">
            <h2>Param√®tres techniques</h2>
            <button id="closeSidebarBtn" class="close-sidebar-btn" aria-label="Fermer">√ó</button>
        </div>
        <div class="mobile-sidebar-content">
            <!-- Le contenu sera d√©plac√© ici en JavaScript en mode mobile -->
        </div>
    </div>

    <!-- Overlay pour fermer le menu -->
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <!-- Main Container (Grid 2 colonnes) -->
    <main class="app-container">
        <!-- Section Viewport (Gauche) -->
        <section class="viewport-section" id="viewportSection">
            <div class="viewport-container">
                <!-- Section Donn√©es Techniques (en haut sur une ligne) -->
                <div class="technical-controls">
                    <!-- US-019 : S√©lection Base de Donn√©es -->
                    <div class="form-group">
                        <label for="selectDatabase">Base de donn√©es</label>
                        <select id="selectDatabase" name="database" class="form-control">
                            <option value="" disabled selected>Chargement...</option>
                            <!-- Options ajout√©es dynamiquement par JS -->
                        </select>
                    </div>

                    <!-- Dimensions Image -->
                    <div class="form-group">
                        <label>Dimensions Image</label>
                        <div class="dimensions-group">
                            <input
                                type="number"
                                id="inputWidth"
                                name="imageWidth"
                                class="form-control"
                                placeholder="1920"
                                value="1920"
                                min="100"
                                max="10000"
                            >
                            <span>√ó</span>
                            <input
                                type="number"
                                id="inputHeight"
                                name="imageHeight"
                                class="form-control"
                                placeholder="1080"
                                value="1080"
                                min="100"
                                max="10000"
                            >
                        </div>
                    </div>

                    <!-- US-021 : T√©l√©chargement JSON -->
                    <div class="form-group">
                        <button type="button" class="btn btn-download" id="btnDownloadJSON" title="T√©l√©charger la configuration JSON">
                            ‚¨á Download JSON
                        </button>
                    </div>

                    <!-- US-032 : T√©l√©chargement multiple d'images -->
                    <div class="form-group">
                        <button type="button" class="btn btn-secondary" id="btnBulkDownload" title="T√©l√©charger plusieurs images">
                            üì• T√©l√©charger plusieurs images
                        </button>
                    </div>
                </div>

                <div class="viewport-header">
                    <h2>Aper√ßu</h2>
                    <!-- S√©lecteur de vue Ext/Int/Config/Overview -->
                    <div class="view-selector">
                        <div class="toggle-group">
                            <button type="button" class="toggle-btn active" id="btnViewExterior" data-view="exterior">
                                Ext√©rieur
                            </button>
                            <button type="button" class="toggle-btn" id="btnViewInterior" data-view="interior">
                                Int√©rieur
                            </button>
                            <button type="button" class="toggle-btn" id="btnViewConfiguration" data-view="configuration">
                                Configuration
                            </button>
                            <button type="button" class="toggle-btn" id="btnViewOverview" data-view="overview">
                                Overview
                            </button>
                        </div>
                    </div>
                    <div class="viewport-actions">
                        <button class="btn btn-icon" id="btnFullscreen" title="Plein √©cran">
                            <span class="icon-fullscreen">‚õ∂</span>
                        </button>
                    </div>
                </div>

                <!-- Zone d'affichage des images (mosa√Øque) -->
                <div class="viewport-display" id="viewportDisplay">
                    <div class="viewport-placeholder">
                        <p>S√©lectionnez une configuration pour g√©n√©rer le rendu</p>
                    </div>

                    <!-- Loader (cach√© par d√©faut) -->
                    <div class="viewport-loader hidden" id="viewportLoader">
                        <div class="spinner"></div>
                        <p>Chargement</p>
                    </div>

                    <!-- Message d'erreur (cach√© par d√©faut) -->
                    <div class="viewport-error hidden" id="viewportError">
                        <p class="error-message"></p>
                        <button class="btn-retry" id="btnRetry">R√©essayer</button>
                    </div>

                    <!-- US-032 : Contr√¥les mode s√©lection -->
                    <div id="selectionControls" class="selection-controls hidden">
                        <span id="selectionCounter" class="selection-counter">0 images s√©lectionn√©es</span>
                        <button type="button" id="btnDownloadSelected" class="btn btn-primary" disabled>
                            T√©l√©charger la s√©lection (0)
                        </button>
                        <button type="button" id="btnCancelSelection" class="btn btn-secondary">
                            Annuler
                        </button>
                    </div>

                    <!-- US-032 : Barre de progression t√©l√©chargement -->
                    <div id="downloadProgress" class="download-progress hidden">
                        <p id="downloadStatus">T√©l√©chargement en cours...</p>
                        <div class="progress-bar">
                            <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- Mosa√Øque d'images (ajout√© dynamiquement par JS) -->
                    <div class="mosaic-grid hidden" id="mosaicGrid">
                        <!-- Images ajout√©es dynamiquement par renderMosaic() -->
                    </div>

                    <!-- US-044 : Mosa√Øque Overview -->
                    <div class="overview-mosaic hidden" id="overviewMosaic">
                        <!-- Image principale avec filigrane -->
                        <div class="overview-main-image-wrapper" id="overviewMainWrapper">
                            <div class="airplane-type-watermark" id="airplaneTypeWatermark">960</div>
                            <img id="overviewImageA" class="overview-main-image" alt="Overview principal" />
                            <!-- Bouton download et checkbox ajout√©s dynamiquement -->
                        </div>

                        <!-- Images secondaires (B, C, D) -->
                        <div class="overview-secondary-images" id="overviewSecondaryWrapper">
                            <!-- Wrappers avec download/checkbox ajout√©s dynamiquement -->
                        </div>
                    </div>
                </div>

                <!-- Actions contextuelles sous la mosa√Øque -->
                <div class="viewport-actions-panel">
                    <!-- Actions EXT√âRIEUR : D√©cor + Portes -->
                    <div id="actions-exterior" class="actions-section">
                        <div class="form-group">
                            <label for="selectDecor">D√©cor</label>
                            <select id="selectDecor" name="decor" class="form-control"></select>
                        </div>
                        <div class="form-group">
                            <label>Porte pilote</label>
                            <div class="toggle-group">
                                <button type="button" class="toggle-btn active" id="btnDoorPilotClosed" data-value="Closed">Ferm√©e</button>
                                <button type="button" class="toggle-btn" id="btnDoorPilotOpen" data-value="Open">Ouverte</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Porte passager</label>
                            <div class="toggle-group">
                                <button type="button" class="toggle-btn active" id="btnDoorPassengerClosed" data-value="Closed">Ferm√©e</button>
                                <button type="button" class="toggle-btn" id="btnDoorPassengerOpen" data-value="Open">Ouverte</button>
                            </div>
                        </div>
                    </div>

                    <!-- Actions INT√âRIEUR : Accessoires -->
                    <div id="actions-interior" class="actions-section" style="display: none;">
                        <!-- D√©cor (partag√© avec Ext√©rieur) -->
                        <div class="form-group">
                            <label for="selectDecorInterior">D√©cor</label>
                            <select id="selectDecorInterior" name="decor" class="form-control"></select>
                        </div>
                        <div class="form-group">
                            <label>Volet Hublots</label>
                            <div class="toggle-group">
                                <button type="button" class="toggle-btn active" id="btnSunGlassOFF" data-value="SunGlassOFF">OFF</button>
                                <button type="button" class="toggle-btn" id="btnSunGlassON" data-value="SunGlassON">ON</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Tablette</label>
                            <div class="toggle-group">
                                <button type="button" class="toggle-btn active" id="btnTabletClosed" data-value="Closed">Ferm√©e</button>
                                <button type="button" class="toggle-btn" id="btnTabletOpen" data-value="Open">Ouverte</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Mood Lights</label>
                            <div class="toggle-group">
                                <button type="button" class="toggle-btn active" id="btnMoodLightsOFF" data-value="Lighting_Mood_OFF">OFF</button>
                                <button type="button" class="toggle-btn" id="btnMoodLightsON" data-value="Lighting_Mood_ON">ON</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section Controls (Droite) -->
        <aside class="controls-section" id="controlsSection">
            <div class="controls-container">
                <!-- US-028 : Affichage conditionnel selon vue (Ext√©rieur / Int√©rieur) -->

                <!-- SECTION EXT√âRIEUR (visible par d√©faut) -->
                <div id="controls-exterior" class="controls-view-section">
                    <!-- Accord√©on Ext√©rieur -->

                    <!-- 1. Avion -->
                    <div class="accordion-section active">
                        <div class="accordion-header">
                            <span>Avion</span>
                            <span class="accordion-icon">‚ñº</span>
                        </div>
                        <div class="accordion-content">
                            <div class="form-group">
                                <label for="selectVersion">Mod√®le</label>
                                <select id="selectVersion" name="version" class="form-control"></select>
                            </div>
                        </div>
                    </div>

                    <!-- 2. Peinture -->
                    <div class="accordion-section">
                        <div class="accordion-header">
                            <span>Peinture</span>
                            <span class="accordion-icon">‚ñº</span>
                        </div>
                        <div class="accordion-content">
                            <div class="form-group">
                                <label for="selectPaintScheme">Sch√©ma</label>
                                <select id="selectPaintScheme" name="paintScheme" class="form-control"></select>
                            </div>
                        </div>
                    </div>

                    <!-- 3. Zones Personnalis√©es -->
                    <div class="accordion-section">
                        <div class="accordion-header">
                            <span>Zones Personnalis√©es</span>
                            <span class="accordion-icon">‚ñº</span>
                        </div>
                        <div class="accordion-content">
                            <!-- Zone A -->
                            <div class="form-group">
                                <label for="selectZoneA">Zone A</label>
                                <input
                                    type="text"
                                    id="searchZoneA"
                                    class="form-control search-input"
                                    placeholder="Rechercher..."
                                    autocomplete="off"
                                >
                                <select id="selectZoneA" name="zoneA" class="form-control"></select>
                            </div>

                            <!-- Zone B -->
                            <div class="form-group">
                                <label for="selectZoneB">Zone B</label>
                                <input
                                    type="text"
                                    id="searchZoneB"
                                    class="form-control search-input"
                                    placeholder="Rechercher..."
                                    autocomplete="off"
                                >
                                <select id="selectZoneB" name="zoneB" class="form-control"></select>
                            </div>

                            <!-- Zone C -->
                            <div class="form-group">
                                <label for="selectZoneC">Zone C</label>
                                <input
                                    type="text"
                                    id="searchZoneC"
                                    class="form-control search-input"
                                    placeholder="Rechercher..."
                                    autocomplete="off"
                                >
                                <select id="selectZoneC" name="zoneC" class="form-control"></select>
                            </div>

                            <!-- Zone D -->
                            <div class="form-group">
                                <label for="selectZoneD">Zone D</label>
                                <input
                                    type="text"
                                    id="searchZoneD"
                                    class="form-control search-input"
                                    placeholder="Rechercher..."
                                    autocomplete="off"
                                >
                                <select id="selectZoneD" name="zoneD" class="form-control"></select>
                            </div>

                            <!-- Zone A+ -->
                            <div class="form-group">
                                <label for="selectZoneAPlus">Zone A+</label>
                                <input
                                    type="text"
                                    id="searchZoneAPlus"
                                    class="form-control search-input"
                                    placeholder="Rechercher..."
                                    autocomplete="off"
                                >
                                <select id="selectZoneAPlus" name="zoneAPlus" class="form-control"></select>
                            </div>
                        </div>
                    </div>

                    <!-- 4. H√©lice -->
                    <div class="accordion-section">
                        <div class="accordion-header">
                            <span>H√©lice</span>
                            <span class="accordion-icon">‚ñº</span>
                        </div>
                        <div class="accordion-content">
                            <div class="form-group">
                                <label for="selectSpinner">Finition</label>
                                <select id="selectSpinner" name="spinner" class="form-control"></select>
                            </div>
                        </div>
                    </div>

                    <!-- 5. Immatriculation -->
                    <div class="accordion-section">
                        <div class="accordion-header">
                            <span>Immatriculation</span>
                            <span class="accordion-icon">‚ñº</span>
                        </div>
                        <div class="accordion-content">
                            <div class="form-group">
                                <label for="inputImmat">Num√©ro</label>
                                <div class="input-group">
                                    <input type="text" id="inputImmat" name="immat" class="form-control" maxlength="6" placeholder="N960TB" value="N960TB">
                                    <button type="button" class="btn btn-primary" id="btnSubmitImmat">Envoyer</button>
                                </div>
                                <span class="form-error hidden" id="errorImmat">Maximum 6 caract√®res alphanum√©riques</span>
                            </div>
                            <div class="form-group">
                                <label>Type Police</label>
                                <div class="radio-group">
                                    <label class="radio-label">
                                        <input type="radio" name="fontType" value="slanted" id="radioSlanted" checked>
                                        <span>Slanted</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="fontType" value="straight" id="radioStraight">
                                        <span>Straight</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="selectStyle">Style</label>
                                <select id="selectStyle" name="style" class="form-control"></select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECTION INT√âRIEUR (masqu√©e par d√©faut) -->
                <div id="controls-interior" class="controls-view-section" style="display: none;">
                    <!-- Accord√©on Int√©rieur -->

                    <!-- 1. Prestige -->
                    <div class="accordion-section active">
                        <div class="accordion-header">
                            <span>Prestige</span>
                            <span class="accordion-icon">‚ñº</span>
                        </div>
                        <div class="accordion-content">
                            <div class="form-group">
                                <label for="selectPrestige">Collection</label>
                                <select id="selectPrestige" name="prestige" class="form-control"></select>
                            </div>
                        </div>
                    </div>

                    <!-- 2. Si√®ges -->
                    <div class="accordion-section">
                        <div class="accordion-header">
                            <span>Si√®ges</span>
                            <span class="accordion-icon">‚ñº</span>
                        </div>
                        <div class="accordion-content">
                            <!-- US-035 : Ordre r√©organis√© -->
                            <!-- 1. Cuir des si√®ges -->
                            <div class="form-group">
                                <label for="seat-covers">Cuir des si√®ges</label>
                                <select id="seat-covers" class="form-control"></select>
                            </div>
                            <!-- 2. Ultra-Suede Ribbon (d√©plac√© de Mat√©riaux) -->
                            <div class="form-group">
                                <label for="ultra-suede-ribbon">Ruban Ultra-Suede</label>
                                <select id="ultra-suede-ribbon" class="form-control"></select>
                            </div>
                            <!-- 3. Stitching (US-036) -->
                            <div class="form-group">
                                <label for="stitching">Stitching</label>
                                <select id="stitching" class="form-control"></select>
                            </div>
                            <!-- 4. Mat√©riau Central (US-037 : Toggle buttons) -->
                            <div class="form-group">
                                <label>Mat√©riau central</label>
                                <div class="toggle-group">
                                    <button type="button" class="toggle-btn" id="btnCentralSeatSuede" data-value="Ultra-Suede_Premium">Suede</button>
                                    <button type="button" class="toggle-btn active" id="btnCentralSeatCuir" data-value="Leather_Premium">Cuir</button>
                                </div>
                            </div>
                            <!-- 5. Perforation des si√®ges -->
                            <div class="form-group">
                                <label>Perforation des si√®ges</label>
                                <div class="radio-group">
                                    <label class="radio-label">
                                        <input type="radio" name="perforated-seat" value="NoSeatPerforation_Premium" checked>
                                        <span>OFF</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="perforated-seat" value="SeatCenterPerforation_Premium">
                                        <span>ON</span>
                                    </label>
                                </div>
                            </div>
                            <!-- 6. Ceintures (d√©plac√© apr√®s Perforation) -->
                            <div class="form-group">
                                <label for="seatbelts">Ceintures</label>
                                <select id="seatbelts" class="form-control"></select>
                            </div>
                        </div>
                    </div>

                    <!-- 4. Mat√©riaux -->
                    <div class="accordion-section">
                        <div class="accordion-header">
                            <span>Mat√©riaux</span>
                            <span class="accordion-icon">‚ñº</span>
                        </div>
                        <div class="accordion-content">
                            <div class="form-group">
                                <label for="carpet">Tapis</label>
                                <select id="carpet" class="form-control"></select>
                            </div>
                            <div class="form-group">
                                <label for="tablet-finish">Bois tablette</label>
                                <select id="tablet-finish" class="form-control"></select>
                            </div>
                            <div class="form-group">
                                <label for="metal-finish">Finition m√©tal</label>
                                <select id="metal-finish" class="form-control"></select>
                            </div>
                            <div class="form-group">
                                <label for="upper-side-panel">Panneau sup√©rieur</label>
                                <select id="upper-side-panel" class="form-control"></select>
                            </div>
                            <div class="form-group">
                                <label for="lower-side-panel">Panneau inf√©rieur</label>
                                <select id="lower-side-panel" class="form-control"></select>
                            </div>
                            <!-- US-035 : Ultra-Suede Ribbon d√©plac√© vers section Si√®ges -->
                        </div>
                    </div>
                </div>
            </div>
        </aside>
    </main>

    <!-- Footer -->
    <footer class="app-footer">
        <p>&copy; 2025 Configurateur Technique TEST Lumiscaphe - Version 1.0</p>
        <p>Plateforme de test et validation technique</p>
    </footer>

    <!-- US-020 : Modal plein √©cran -->
    <div class="fullscreen-modal hidden" id="fullscreenModal">
        <div class="fullscreen-backdrop" id="fullscreenBackdrop"></div>
        <div class="fullscreen-content">
            <button class="fullscreen-close" id="fullscreenClose">‚úï</button>
            <button class="fullscreen-nav fullscreen-prev" id="fullscreenPrev">
                <span>‚Äπ</span>
            </button>
            <img class="fullscreen-image" id="fullscreenImage" src="" alt="Image plein √©cran">
            <button class="fullscreen-nav fullscreen-next" id="fullscreenNext">
                <span>‚Ä∫</span>
            </button>
            <div class="fullscreen-counter" id="fullscreenCounter">1 / 1</div>
            <div class="fullscreen-metadata" id="fullscreenMetadata"></div>
            <!-- US-044 : Bouton t√©l√©chargement dans le modal -->
            <button class="fullscreen-download" id="fullscreenDownload" title="T√©l√©charger cette image">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
            </button>
        </div>
    </div>

    <!-- Modal Configuration / Sch√©mas XML -->
    <div class="config-schema-modal hidden" id="configSchemaModal">
        <div class="config-schema-backdrop" id="configSchemaBackdrop"></div>
        <div class="config-schema-content">
            <div class="config-schema-header">
                <h2>üìä Sch√©mas XML - Documentation de la Base de Donn√©es</h2>
                <button class="config-schema-close" id="configSchemaClose">‚úï</button>
            </div>

            <div class="config-schema-body">
                <!-- Informations g√©n√©rales -->
                <section class="config-section">
                    <h3>‚ÑπÔ∏è Informations G√©n√©rales</h3>
                    <div id="configGeneralInfo" class="config-info-grid">
                        <div class="config-info-item">
                            <strong>Base de donn√©es:</strong>
                            <span id="configDbName">-</span>
                        </div>
                        <div class="config-info-item">
                            <strong>ID:</strong>
                            <span id="configDbId" class="monospace">-</span>
                        </div>
                        <div class="config-info-item">
                            <strong>Analys√© le:</strong>
                            <span id="configAnalyzedAt">-</span>
                        </div>
                    </div>
                </section>

                <!-- Features disponibles -->
                <section class="config-section">
                    <h3>‚ú® Features Disponibles</h3>
                    <div id="configFeatures" class="config-features-grid">
                        <!-- G√©n√©r√© dynamiquement -->
                    </div>
                </section>

                <!-- Camera Groups -->
                <section class="config-section">
                    <h3>üì∑ Camera Groups</h3>
                    <div id="configCameraGroups" class="config-camera-groups">
                        <!-- G√©n√©r√© dynamiquement -->
                    </div>
                </section>

                <!-- Parameters -->
                <section class="config-section">
                    <h3>‚öôÔ∏è Parameters</h3>
                    <div id="configParameters" class="config-parameters">
                        <!-- G√©n√©r√© dynamiquement -->
                    </div>
                </section>

                <!-- Prestige Options -->
                <section class="config-section">
                    <h3>üé® Prestige Options</h3>
                    <div id="configPrestiges" class="config-prestiges">
                        <!-- G√©n√©r√© dynamiquement -->
                    </div>
                </section>

                <!-- Configuration Bookmarks -->
                <section class="config-section">
                    <h3>üîñ Configuration Bookmarks</h3>
                    <div id="configBookmarks" class="config-bookmarks">
                        <!-- G√©n√©r√© dynamiquement -->
                    </div>
                </section>
            </div>

            <div class="config-schema-footer">
                <button id="exportCurrentSchemaBtn" class="btn-primary">
                    üì• Exporter cette base
                </button>
                <button id="exportAllSchemasBtn" class="btn-primary">
                    üì• Exporter toutes les bases
                </button>
                <button id="closeConfigSchemaBtn" class="btn-secondary">
                    Fermer
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts JS (modules ES6) -->
    <script type="module" src="js/app.js"></script>
</body>
</html>
